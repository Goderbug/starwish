import React from 'react';
import { ArrowLeft, LogIn, LogOut, User } from 'lucide-react';
import { useAuth } from '../hooks/useAuth';
import { useLanguage } from '../contexts/LanguageContext';
import { signOut } from '../lib/supabase';
import LanguageSwitcher from './LanguageSwitcher';

interface HeaderProps {
  showBackButton?: boolean;
  onBack?: () => void;
  onAuthRequired?: () => void;
}

const Header: React.FC<HeaderProps> = ({ 
  showBackButton, 
  onBack, 
  onAuthRequired 
}) => {
  const { user, loading } = useAuth();
  const { t } = useLanguage();

  const handleSignOut = async () => {
    console.log('🔄 Header: 开始登出');
    
    try {
      await signOut();
      console.log('✅ Header: 登出完成');
      // ✅ 由于禁用了持久化，登出后会立即清除所有状态
      // 用户将被重定向到首页，需要重新登录才能访问任何功能
    } catch (error) {
      console.error('❌ Header: 登出错误:', error);
    }
  };

  const handleSignIn = () => {
    console.log('🔐 Header: 触发登录');
    if (onAuthRequired) {
      onAuthRequired();
    }
  };

  return (
    <header className="fixed top-0 left-0 right-0 z-50 bg-gradient-to-b from-black/20 to-transparent backdrop-blur-sm">
      <div className="flex items-center justify-between p-4 sm:p-6">
        {/* Left side - Logo (只在首页显示) 和 Back button */}
        <div className="flex items-center space-x-4">
          {/* Logo - 只在非back button页面显示，避免挤压 */}
          {!showBackButton && (
            <div className="flex items-center">
              <svg 
                width="157" 
                height="60" 
                viewBox="0 0 157 60" 
                fill="none" 
                xmlns="http://www.w3.org/2000/svg"
                className="h-[48px] sm:h-[60px] w-auto transition-all duration-300"
              >
                <path d="M59.1616 45.2731C56.1351 45.2731 53.7116 44.7042 51.8912 43.5664C50.0708 42.4059 49.1605 40.6423 49.1605 38.2757C49.1605 37.0242 49.3767 36.0684 49.8091 35.4085C50.2414 34.7486 50.8786 34.4187 51.7205 34.4187C52.3349 34.4187 52.8356 34.578 53.2224 34.8965C53.6092 35.2151 53.8027 35.6247 53.8027 36.1253C53.8027 36.5804 53.7685 36.9787 53.7003 37.32C53.7003 37.411 53.6775 37.5703 53.632 37.7979C53.6092 38.0254 53.5979 38.2644 53.5979 38.5147C53.5979 39.5387 54.1099 40.301 55.1339 40.8016C56.1806 41.3022 57.637 41.5525 59.5029 41.5525C61.4372 41.5525 62.9504 41.2112 64.0427 40.5285C65.1349 39.8231 65.6811 38.8446 65.6811 37.5931C65.6811 36.8194 65.4308 36.1595 64.9301 35.6133C64.4295 35.0444 63.8037 34.578 63.0528 34.2139C62.3019 33.827 61.2437 33.3605 59.8784 32.8144C58.1262 32.1317 56.6926 31.4832 55.5776 30.8688C54.4853 30.2544 53.541 29.4238 52.7445 28.3771C51.9708 27.3076 51.584 25.9877 51.584 24.4176C51.584 22.7792 52.0164 21.3228 52.8811 20.0485C53.7685 18.7742 55.0315 17.7844 56.6699 17.0789C58.331 16.3735 60.2766 16.0208 62.5067 16.0208C64.1678 16.0208 65.6924 16.2711 67.0805 16.7717C68.4686 17.2496 69.5723 17.9892 70.3915 18.9904C71.2334 19.9916 71.6544 21.2204 71.6544 22.6768C71.6544 24.1104 71.4382 25.1913 71.0059 25.9195C70.5735 26.6476 69.9364 27.0117 69.0944 27.0117C68.5028 27.0117 68.0021 26.8297 67.5925 26.4656C67.2057 26.1015 67.0123 25.6692 67.0123 25.1685C67.0123 24.7362 67.0464 24.338 67.1147 23.9739C67.1829 23.2912 67.2171 22.8588 67.2171 22.6768C67.2171 21.7211 66.7506 20.9929 65.8176 20.4923C64.8846 19.9916 63.7241 19.7413 62.336 19.7413C60.379 19.7413 58.8772 20.1054 57.8304 20.8336C56.8064 21.539 56.2944 22.5403 56.2944 23.8373C56.2944 24.702 56.5561 25.4416 57.0795 26.056C57.6256 26.6704 58.2969 27.1824 59.0933 27.592C59.8898 28.0016 61.0048 28.4908 62.4384 29.0597C64.1678 29.7652 65.5559 30.4023 66.6027 30.9712C67.6494 31.5401 68.5369 32.3138 69.2651 33.2923C70.016 34.2708 70.3915 35.4768 70.3915 36.9104C70.3915 39.5956 69.3675 41.6663 67.3195 43.1227C65.2942 44.5563 62.5749 45.2731 59.1616 45.2731ZM88.1952 37.3883C88.491 37.3883 88.7186 37.5248 88.8779 37.7979C89.0599 38.0709 89.1509 38.4464 89.1509 38.9243C89.1509 39.8345 88.9348 40.5399 88.5024 41.0405C87.5239 42.2466 86.4544 43.2364 85.2939 44.0101C84.1333 44.7838 82.8021 45.1707 81.3003 45.1707C76.6581 45.1707 74.3371 41.9052 74.3371 35.3744C74.3371 34.3732 74.3712 33.3605 74.4395 32.3365H73.1083C72.4256 32.3365 71.9591 32.2114 71.7088 31.9611C71.4812 31.7108 71.3675 31.3125 71.3675 30.7664C71.3675 29.4921 71.8795 28.8549 72.9035 28.8549H74.8491C75.2359 26.3518 75.8276 24.0649 76.624 21.9941C77.4204 19.9234 78.3762 18.2736 79.4912 17.0448C80.629 15.816 81.8464 15.2016 83.1435 15.2016C84.0992 15.2016 84.8501 15.6226 85.3963 16.4645C85.9424 17.3065 86.2155 18.3646 86.2155 19.6389C86.2155 23.166 84.7364 26.238 81.7781 28.8549H85.6011C85.9652 28.8549 86.2268 28.9346 86.3861 29.0939C86.5454 29.2532 86.6251 29.549 86.6251 29.9813C86.6251 31.5515 85.3394 32.3365 82.768 32.3365H78.6037C78.5582 33.4743 78.5355 34.3618 78.5355 34.9989C78.5355 37.3655 78.8085 39.0267 79.3547 39.9824C79.9236 40.9381 80.811 41.416 82.0171 41.416C82.9956 41.416 83.8603 41.1202 84.6112 40.5285C85.3621 39.9369 86.2496 39.0494 87.2736 37.8661C87.5467 37.5476 87.8539 37.3883 88.1952 37.3883ZM82.2219 18.4784C81.8805 18.4784 81.4937 18.9108 81.0613 19.7755C80.6517 20.6174 80.2535 21.8007 79.8667 23.3253C79.5026 24.8272 79.1954 26.4997 78.9451 28.3429C80.2876 27.1824 81.2889 25.8853 81.9488 24.4517C82.6315 22.9954 82.9728 21.6756 82.9728 20.4923C82.9728 19.1497 82.7225 18.4784 82.2219 18.4784ZM90.5701 45.1707C89.1593 45.1707 88.0329 44.6587 87.1909 43.6347C86.349 42.6107 85.928 41.2681 85.928 39.6069C85.928 37.7865 86.349 36.0684 87.1909 34.4528C88.0329 32.8144 89.1479 31.506 90.536 30.5275C91.9468 29.5262 93.4373 29.0256 95.0075 29.0256C95.5081 29.0256 95.838 29.128 95.9973 29.3328C96.1794 29.5148 96.3273 29.8562 96.4411 30.3568C96.9189 30.2658 97.4196 30.2203 97.9429 30.2203C99.058 30.2203 99.6155 30.6185 99.6155 31.4149C99.6155 31.8928 99.4448 33.0306 99.1035 34.8283C98.5801 37.4452 98.3184 39.2656 98.3184 40.2896C98.3184 40.6309 98.398 40.904 98.5573 41.1088C98.7394 41.3136 98.9669 41.416 99.24 41.416C99.6724 41.416 100.196 41.1429 100.81 40.5968C101.425 40.0279 102.255 39.1177 103.302 37.8661C103.575 37.5476 103.882 37.3883 104.223 37.3883C104.519 37.3883 104.747 37.5248 104.906 37.7979C105.088 38.0709 105.179 38.4464 105.179 38.9243C105.179 39.8345 104.963 40.5399 104.531 41.0405C103.598 42.2011 102.608 43.1796 101.561 43.976C100.514 44.7724 99.5017 45.1707 98.5232 45.1707C97.7723 45.1707 97.0782 44.9204 96.4411 44.4197C95.8267 43.8964 95.3602 43.1909 95.0416 42.3035C93.8583 44.2149 92.3678 45.1707 90.5701 45.1707ZM91.7989 41.7232C92.2996 41.7232 92.7774 41.4274 93.2325 40.8357C93.6876 40.2441 94.0176 39.459 94.2224 38.4805L95.4853 32.2C94.5296 32.2228 93.6421 32.5868 92.8229 33.2923C92.0265 33.9749 91.3893 34.8852 90.9115 36.0229C90.4336 37.1607 90.1947 38.3668 90.1947 39.6411C90.1947 40.3465 90.3312 40.8699 90.6043 41.2112C90.9001 41.5525 91.2983 41.7232 91.7989 41.7232ZM104.829 45.1707C103.964 45.1707 103.349 44.7156 102.985 43.8053C102.644 42.8951 102.473 41.4388 102.473 39.4363C102.473 36.478 102.894 33.6677 103.736 31.0053C103.941 30.3454 104.271 29.8676 104.726 29.5717C105.204 29.2532 105.864 29.0939 106.706 29.0939C107.161 29.0939 107.48 29.1508 107.662 29.2645C107.844 29.3783 107.935 29.5945 107.935 29.9131C107.935 30.2772 107.764 31.0964 107.423 32.3707C107.195 33.2809 107.013 34.0773 106.877 34.76C106.74 35.4427 106.626 36.2846 106.535 37.2859C107.286 35.3289 108.128 33.736 109.061 32.5072C109.994 31.2784 110.904 30.4023 111.792 29.8789C112.702 29.3556 113.533 29.0939 114.283 29.0939C115.763 29.0939 116.502 29.8334 116.502 31.3125C116.502 31.6084 116.4 32.3252 116.195 33.4629C116.013 34.3732 115.922 34.942 115.922 35.1696C115.922 35.966 116.206 36.3643 116.775 36.3643C117.412 36.3643 118.232 35.8636 119.233 34.8624C119.529 34.5666 119.836 34.4187 120.154 34.4187C120.45 34.4187 120.678 34.5552 120.837 34.8283C121.019 35.0786 121.11 35.4199 121.11 35.8523C121.11 36.6942 120.883 37.3541 120.427 37.832C119.79 38.4919 119.039 39.0608 118.175 39.5387C117.333 39.9938 116.434 40.2213 115.478 40.2213C114.272 40.2213 113.35 39.9141 112.713 39.2997C112.099 38.6853 111.792 37.8548 111.792 36.808C111.792 36.4667 111.826 36.1253 111.894 35.784C111.94 35.3289 111.962 35.0217 111.962 34.8624C111.962 34.4983 111.837 34.3163 111.587 34.3163C111.246 34.3163 110.79 34.7031 110.222 35.4768C109.675 36.2277 109.129 37.229 108.583 38.4805C108.037 39.7321 107.593 41.0519 107.252 42.44C107.002 43.5095 106.706 44.2377 106.365 44.6245C106.046 44.9886 105.534 45.1707 104.829 45.1707ZM144.769 34.6235C144.837 34.6007 144.951 34.5893 145.11 34.5893C145.451 34.5893 145.713 34.7031 145.895 34.9307C146.077 35.1582 146.168 35.4654 146.168 35.8523C146.168 36.5577 146.031 37.1152 145.758 37.5248C145.485 37.9116 145.076 38.1961 144.53 38.3781C143.483 38.7195 142.368 38.8901 141.185 38.8901C140.183 38.8901 139.239 38.7536 138.351 38.4805C137.692 39.55 136.963 40.6537 136.167 41.7915C135.257 43.0885 134.472 43.976 133.812 44.4539C133.175 44.9317 132.446 45.1707 131.627 45.1707C130.717 45.1707 130.023 44.818 129.545 44.1125C129.09 43.4071 128.806 42.2466 128.692 40.6309L128.521 38.1392C127.816 40.0507 127.178 41.507 126.61 42.5083C126.063 43.5095 125.506 44.2036 124.937 44.5904C124.391 44.9772 123.742 45.1707 122.991 45.1707C122.058 45.1707 121.319 44.8066 120.773 44.0784C120.249 43.3502 119.919 42.2011 119.783 40.6309C119.51 37.4452 119.373 34.6576 119.373 32.2683V31.0736C119.396 30.3227 119.601 29.7993 119.988 29.5035C120.375 29.2076 120.955 29.0597 121.729 29.0597C122.32 29.0597 122.753 29.1963 123.026 29.4693C123.321 29.7196 123.469 30.152 123.469 30.7664C123.469 33.3833 123.629 36.7852 123.947 40.9723C125.495 37.7182 126.917 34.3276 128.214 30.8005C128.464 30.1179 128.76 29.6628 129.101 29.4352C129.465 29.1849 129.898 29.0597 130.398 29.0597C131.013 29.0597 131.434 29.1849 131.661 29.4352C131.912 29.6855 132.037 30.1292 132.037 30.7664C132.037 33.3833 132.196 36.7852 132.515 40.9723C133.88 38.947 134.904 37.3314 135.587 36.1253C135.245 35.4654 135.075 34.6804 135.075 33.7701C135.075 32.9964 135.245 32.2455 135.587 31.5173C135.928 30.7892 136.394 30.1975 136.986 29.7424C137.578 29.2873 138.249 29.0597 139 29.0597C139.66 29.0597 140.195 29.2987 140.604 29.7765C141.014 30.2316 141.219 30.9029 141.219 31.7904C141.219 32.8144 140.946 33.9863 140.399 35.3061C141.264 35.2606 142.413 35.09 143.847 34.7941L144.769 34.6235ZM147.677 26.8411C146.721 26.8411 146.004 26.6249 145.526 26.1925C145.048 25.7374 144.809 25.1116 144.809 24.3152C144.809 23.5188 145.117 22.8588 145.731 22.3355C146.368 21.7893 147.153 21.5163 148.086 21.5163C148.928 21.5163 149.611 21.7211 150.134 22.1307C150.658 22.5403 150.919 23.1205 150.919 23.8715C150.919 24.7817 150.623 25.5099 150.032 26.056C149.44 26.5794 148.655 26.8411 147.677 26.8411ZM147.403 45.1707C145.924 45.1707 144.843 44.6473 144.161 43.6005C143.501 42.5538 143.171 41.1657 143.171 39.4363C143.171 38.4123 143.296 37.1038 143.546 35.5109C143.819 33.8953 144.161 32.3934 144.57 31.0053C144.775 30.2772 145.048 29.7765 145.39 29.5035C145.731 29.2304 146.277 29.0939 147.028 29.0939C148.189 29.0939 148.769 29.4807 148.769 30.2544C148.769 30.8233 148.553 32.1431 148.12 34.2139C147.574 36.717 147.301 38.4123 147.301 39.2997C147.301 39.9824 147.392 40.5058 147.574 40.8699C147.756 41.234 148.063 41.416 148.496 41.416C148.905 41.416 149.417 41.1316 150.032 40.5627C150.646 39.9938 151.465 39.0949 152.489 37.8661C152.762 37.5476 153.07 37.3883 153.411 37.3883C153.707 37.3883 153.934 37.5248 154.094 37.7979C154.276 38.0709 154.367 38.4464 154.367 38.9243C154.367 39.8345 154.15 40.5399 153.718 41.0405C151.465 43.794 149.36 45.1707 147.403 45.1707ZM157.954 45.9216C156.771 45.9216 155.86 45.6485 155.223 45.1024C154.609 44.5563 154.302 43.9419 154.302 43.2592C154.302 42.6676 154.518 42.1556 154.95 41.7232C155.382 41.2908 156.02 41.0747 156.862 41.0747C157.157 41.0747 157.499 41.1088 157.886 41.1771C158.295 41.2226 158.602 41.2567 158.807 41.2795C158.784 40.6878 158.648 40.1303 158.398 39.6069C158.17 39.0836 157.874 38.5829 157.51 38.1051C157.146 37.6044 156.805 37.1721 156.486 36.808C155.781 38.1506 155.075 39.2656 154.37 40.1531C153.687 41.0405 152.936 41.8825 152.117 42.6789C151.707 43.0885 151.275 43.2933 150.82 43.2933C150.456 43.2933 150.16 43.1682 149.933 42.9179C149.705 42.6448 149.591 42.3148 149.591 41.928C149.591 41.4729 149.75 41.0519 150.069 40.6651L150.513 40.1189C151.764 38.5716 152.709 37.2972 153.346 36.296C153.733 35.6361 154.188 34.76 154.711 33.6677C155.235 32.5527 155.747 31.4036 156.247 30.2203C156.68 29.219 157.578 28.7184 158.944 28.7184C159.581 28.7184 160.025 28.7753 160.275 28.8891C160.525 29.0028 160.65 29.1849 160.65 29.4352C160.65 29.5717 160.605 29.7879 160.514 30.0837C160.423 30.3796 160.298 30.6754 160.138 30.9712C159.729 31.7904 159.524 32.4844 159.524 33.0533C159.524 33.3947 159.638 33.7701 159.865 34.1797C160.116 34.5893 160.491 35.1013 160.992 35.7157C161.72 36.6715 162.266 37.4907 162.63 38.1733C163.017 38.8332 163.21 39.5614 163.21 40.3579C163.21 40.5854 163.188 40.904 163.142 41.3136C164.257 40.8812 165.566 39.7321 167.067 37.8661C167.341 37.5476 167.648 37.3883 167.989 37.3883C168.285 37.3883 168.512 37.5248 168.672 37.7979C168.854 38.0709 168.945 38.4464 168.945 38.9243C168.945 39.789 168.729 40.4944 168.296 41.0405C167.158 42.4514 166.066 43.4185 165.019 43.9419C163.995 44.4425 162.721 44.7156 161.197 44.7611C160.286 45.5348 159.205 45.9216 157.954 45.9216ZM178.255 29.0939C178.983 29.0939 179.529 29.2873 179.893 29.6741C180.28 30.0382 180.474 30.5844 180.474 31.3125C180.474 31.9042 180.348 33.0192 180.098 34.6576C179.871 36.0457 179.689 37.3655 179.552 38.6171C179.415 39.8459 179.347 41.2226 179.347 42.7472C179.347 43.6119 179.165 44.2377 178.801 44.6245C178.46 44.9886 177.891 45.1707 177.094 45.1707C176.343 45.1707 175.797 44.9772 175.456 44.5904C175.115 44.2036 174.944 43.6233 174.944 42.8496C174.944 41.9394 175.103 40.4375 175.422 38.344C175.695 36.5236 175.831 35.363 175.831 34.8624C175.831 34.4983 175.706 34.3163 175.456 34.3163C175.16 34.3163 174.739 34.7031 174.193 35.4768C173.647 36.2277 173.101 37.229 172.555 38.4805C172.009 39.7321 171.565 41.0519 171.223 42.44C170.973 43.5095 170.677 44.2377 170.336 44.6245C170.017 44.9886 169.505 45.1707 168.8 45.1707C168.095 45.1707 167.571 44.9204 167.23 44.4197C166.911 43.8964 166.695 43.0999 166.581 42.0304C166.468 40.9609 166.411 39.3908 166.411 37.32C166.411 33.8156 166.763 30.1634 167.469 26.3632C168.197 22.563 169.255 19.3772 170.643 16.8059C172.054 14.2117 173.738 12.9147 175.695 12.9147C176.742 12.9147 177.584 13.3698 178.221 14.28C178.881 15.1675 179.211 16.328 179.211 17.7616C179.211 20.0599 178.539 22.4492 177.197 24.9296C175.854 27.3872 173.67 30.2658 170.643 33.5653C170.575 34.7486 170.541 35.966 170.541 37.2176C171.292 35.2834 172.122 33.7132 173.033 32.5072C173.966 31.2784 174.876 30.4023 175.763 29.8789C176.673 29.3556 177.504 29.0939 178.255 29.0939ZM174.978 16.2939C174.569 16.2939 174.113 16.8855 173.613 18.0688C173.112 19.2293 172.623 20.8108 172.145 22.8133C171.69 24.7931 171.314 26.9548 171.019 29.2987C172.43 27.6375 173.59 25.8284 174.5 23.8715C175.433 21.9145 175.9 20.1396 175.9 18.5467C175.9 17.8185 175.82 17.261 175.661 16.8741C175.502 16.4873 175.274 16.2939 174.978 16.2939Z" fill="white"/>
                <path d="M120.542 29.2762C121.065 29.2762 121.44 29.3898 121.667 29.617C121.917 29.8443 122.042 30.1396 122.042 30.5032C122.042 31.094 121.86 31.6166 121.497 32.071C121.156 32.5254 120.611 32.764 119.861 32.7867C118.066 32.8095 116.453 32.6731 115.021 32.3778C113.431 35.7633 111.511 38.5808 109.261 40.8303C107.034 43.057 104.83 44.1704 102.649 44.1704C100.649 44.1704 99.1498 43.1138 98.1501 41.0007C97.1503 38.8649 96.5823 36.0133 96.4459 32.4459C95.0826 36.3995 93.5375 39.342 91.8107 41.2734C90.1065 43.2047 88.2888 44.1704 86.3574 44.1704C84.1761 44.1704 82.5288 42.8185 81.4154 40.1146C80.302 37.3879 79.7453 33.7297 79.7453 29.1399C79.7453 25.7998 80.0407 22.1302 80.6315 18.1311C80.7905 16.995 81.0746 16.2111 81.4836 15.7794C81.9153 15.325 82.5856 15.0978 83.4944 15.0978C84.1761 15.0978 84.6987 15.2454 85.0623 15.5408C85.4485 15.8362 85.6417 16.3815 85.6417 17.1768C85.6417 17.3359 85.6189 17.6426 85.5735 18.097C84.8918 22.755 84.551 26.72 84.551 29.992C84.551 33.0367 84.8123 35.3884 85.3349 37.0471C85.8575 38.7058 86.5619 39.5351 87.4481 39.5351C88.2433 39.5351 89.1976 38.7058 90.311 37.0471C91.4471 35.3657 92.5718 32.889 93.6852 29.617C94.7986 26.3224 95.7415 22.4028 96.5141 17.8585C96.6959 16.8133 97.0253 16.0975 97.5025 15.7112C98.0024 15.3022 98.6727 15.0978 99.5134 15.0978C100.218 15.0978 100.729 15.2568 101.047 15.5749C101.388 15.8703 101.558 16.3247 101.558 16.9382C101.558 17.3018 101.536 17.5858 101.49 17.7903C100.854 21.494 100.536 25.1976 100.536 28.9013C100.536 31.4234 100.615 33.4343 100.774 34.934C100.956 36.4336 101.286 37.5811 101.763 38.3763C102.263 39.1489 102.978 39.5351 103.91 39.5351C105.001 39.5351 106.216 38.7172 107.557 37.0812C108.898 35.4225 110.125 33.3662 111.238 30.9122C109.852 30.0488 108.807 28.9354 108.102 27.5721C107.398 26.186 107.046 24.5955 107.046 22.8005C107.046 21.0054 107.318 19.4944 107.864 18.2675C108.432 17.0177 109.193 16.0862 110.147 15.4727C111.124 14.8592 112.204 14.5524 113.385 14.5524C114.839 14.5524 115.987 15.075 116.827 16.1202C117.691 17.1654 118.123 18.5969 118.123 20.4147C118.123 22.9822 117.566 25.8338 116.453 28.9695C117.611 29.174 118.975 29.2762 120.542 29.2762ZM110.488 22.5619C110.488 24.7886 111.204 26.436 112.635 27.5039C113.521 24.9591 113.965 22.8573 113.965 21.1986C113.965 20.2443 113.84 19.5512 113.59 19.1195C113.34 18.6651 112.999 18.4379 112.567 18.4379C111.954 18.4379 111.454 18.8014 111.067 19.5285C110.681 20.2329 110.488 21.244 110.488 22.5619ZM123.194 25.8679C122.24 25.8679 121.524 25.6521 121.047 25.2204C120.57 24.7659 120.331 24.1411 120.331 23.3458C120.331 22.5505 120.638 21.8916 121.251 21.369C121.888 20.8237 122.671 20.551 123.603 20.551C124.444 20.551 125.125 20.7555 125.648 21.1645C126.171 21.5735 126.432 22.1529 126.432 22.9027C126.432 23.8116 126.137 24.5387 125.546 25.084C124.955 25.6066 124.171 25.8679 123.194 25.8679ZM122.921 44.1704C121.444 44.1704 120.365 43.6478 119.683 42.6026C119.025 41.5574 118.695 40.1714 118.695 38.4445C118.695 37.422 118.82 36.1155 119.07 34.525C119.343 32.9117 119.683 31.4121 120.092 30.026C120.297 29.2989 120.57 28.7991 120.91 28.5264C121.251 28.2537 121.797 28.1174 122.546 28.1174C123.705 28.1174 124.285 28.5037 124.285 29.2762C124.285 29.8443 124.069 31.1621 123.637 33.2298C123.092 35.7292 122.819 37.422 122.819 38.3082C122.819 38.9898 122.91 39.5124 123.092 39.876C123.274 40.2395 123.58 40.4213 124.012 40.4213C124.421 40.4213 124.932 40.1373 125.546 39.5692C126.159 39.0012 126.977 38.1037 128 36.8767C128.272 36.5586 128.579 36.3995 128.92 36.3995C129.215 36.3995 129.443 36.5359 129.602 36.8085C129.783 37.0812 129.874 37.4561 129.874 37.9333C129.874 38.8421 129.658 39.5465 129.227 40.0464C126.977 42.7957 124.875 44.1704 122.921 44.1704ZM133.456 44.9202C132.275 44.9202 131.366 44.6476 130.73 44.1022C130.116 43.5569 129.809 42.9434 129.809 42.2618C129.809 41.671 130.025 41.1598 130.457 40.728C130.889 40.2963 131.525 40.0805 132.366 40.0805C132.661 40.0805 133.002 40.1146 133.388 40.1827C133.797 40.2282 134.104 40.2622 134.308 40.285C134.286 39.6942 134.149 39.1375 133.899 38.6149C133.672 38.0923 133.377 37.5924 133.013 37.1153C132.65 36.6154 132.309 36.1837 131.991 35.8201C131.286 37.1607 130.582 38.2741 129.877 39.1602C129.196 40.0464 128.446 40.8871 127.628 41.6824C127.219 42.0914 126.787 42.2959 126.333 42.2959C125.969 42.2959 125.674 42.1709 125.447 41.9209C125.219 41.6483 125.106 41.3188 125.106 40.9325C125.106 40.4781 125.265 40.0578 125.583 39.6715L126.026 39.1262C127.276 37.5811 128.219 36.3086 128.855 35.3089C129.241 34.6499 129.696 33.7751 130.218 32.6845C130.741 31.5711 131.252 30.4237 131.752 29.2421C132.184 28.2424 133.081 27.7425 134.445 27.7425C135.081 27.7425 135.524 27.7993 135.774 27.9129C136.024 28.0265 136.149 28.2083 136.149 28.4582C136.149 28.5946 136.103 28.8104 136.012 29.1058C135.921 29.4012 135.797 29.6966 135.637 29.992C135.228 30.8099 135.024 31.503 135.024 32.071C135.024 32.4118 135.138 32.7867 135.365 33.1957C135.615 33.6047 135.99 34.116 136.49 34.7295C137.217 35.6838 137.762 36.5018 138.126 37.1834C138.512 37.8424 138.705 38.5695 138.705 39.3647C138.705 39.592 138.682 39.9101 138.637 40.3191C139.75 39.8873 141.057 38.7399 142.556 36.8767C142.829 36.5586 143.136 36.3995 143.477 36.3995C143.772 36.3995 143.999 36.5359 144.158 36.8085C144.34 37.0812 144.431 37.4561 144.431 37.9333C144.431 38.7967 144.215 39.5011 143.783 40.0464C142.647 41.4551 141.557 42.4208 140.511 42.9434C139.489 43.4433 138.216 43.716 136.694 43.7614C135.785 44.534 134.706 44.9202 133.456 44.9202ZM153.727 28.1174C154.454 28.1174 155 28.3105 155.363 28.6968C155.749 29.0604 155.943 29.6057 155.943 30.3328C155.943 30.9235 155.818 32.0369 155.568 33.6729C155.34 35.0589 155.159 36.3768 155.022 37.6265C154.886 38.8535 154.818 40.2282 154.818 41.7505C154.818 42.614 154.636 43.2388 154.273 43.6251C153.932 43.9886 153.364 44.1704 152.568 44.1704C151.819 44.1704 151.273 43.9773 150.932 43.591C150.592 43.2047 150.421 42.6253 150.421 41.8528C150.421 40.9439 150.58 39.4443 150.898 37.3538C151.171 35.5361 151.307 34.3773 151.307 33.8774C151.307 33.5138 151.182 33.3321 150.932 33.3321C150.637 33.3321 150.217 33.7183 149.671 34.4909C149.126 35.2407 148.581 36.2405 148.035 37.4902C147.49 38.7399 147.047 40.0578 146.706 41.4438C146.456 42.5117 146.161 43.2388 145.82 43.6251C145.502 43.9886 144.991 44.1704 144.286 44.1704C143.582 44.1704 143.059 43.9205 142.718 43.4206C142.4 42.898 142.184 42.1027 142.071 41.0348C141.957 39.9669 141.9 38.3991 141.9 36.3314C141.9 32.8322 142.253 29.1853 142.957 25.3908C143.684 21.5962 144.741 18.4151 146.127 15.8476C147.535 13.2573 149.217 11.9621 151.171 11.9621C152.216 11.9621 153.057 12.4166 153.693 13.3254C154.352 14.2116 154.682 15.3704 154.682 16.8019C154.682 19.0968 154.011 21.4826 152.671 23.9593C151.33 26.4133 149.149 29.2876 146.127 32.5822C146.059 33.7638 146.024 34.9794 146.024 36.2291C146.774 34.2978 147.604 32.7299 148.513 31.5257C149.444 30.2987 150.353 29.4239 151.239 28.9013C152.148 28.3787 152.977 28.1174 153.727 28.1174ZM150.455 15.3363C150.046 15.3363 149.592 15.9271 149.092 17.1086C148.592 18.2675 148.104 19.8466 147.626 21.8462C147.172 23.823 146.797 25.9815 146.502 28.3219C147.91 26.6632 149.069 24.8568 149.978 22.9027C150.91 20.9486 151.375 19.1763 151.375 17.5858C151.375 16.8587 151.296 16.302 151.137 15.9157C150.978 15.5295 150.751 15.3363 150.455 15.3363Z" fill="white"/>
              </svg>
            </div>
          )}

          {/* Back button - 只在需要时显示，不会被logo挤压 */}
          {showBackButton && onBack && (
            <button
              onClick={onBack}
              className="p-3 rounded-full bg-white/10 backdrop-blur-sm hover:bg-white/20 transition-colors touch-manipulation"
            >
              <ArrowLeft className="w-5 h-5 sm:w-6 sm:h-6" />
            </button>
          )}
        </div>

        {/* Center - Empty space for better balance */}
        <div className="flex-1"></div>

        {/* Right side - Language switcher and Auth components */}
        <div className="flex items-center space-x-3">
          {/* Language switcher */}
          <LanguageSwitcher />

          {/* Auth section */}
          {loading ? (
            <div className="w-8 h-8 border-2 border-purple-400 border-t-transparent rounded-full animate-spin"></div>
          ) : user ? (
            <div className="flex items-center space-x-3">
              {/* User info */}
              <div className="hidden sm:flex items-center space-x-2 bg-white/10 backdrop-blur-sm rounded-full px-3 py-2">
                <User className="w-4 h-4 text-purple-400" />
                <span className="text-sm font-medium text-white max-w-32 truncate">
                  {user.user_metadata?.full_name || user.user_metadata?.name || user.email?.split('@')[0]}
                </span>
              </div>
              
              {/* Mobile user indicator */}
              <div className="sm:hidden w-8 h-8 bg-white/10 backdrop-blur-sm rounded-full flex items-center justify-center">
                <User className="w-4 h-4 text-purple-400" />
              </div>

              {/* Sign out button */}
              <button
                onClick={handleSignOut}
                className="p-2 bg-white/10 backdrop-blur-sm hover:bg-white/20 rounded-full transition-colors touch-manipulation"
                title={t('landing.signOut')}
              >
                <LogOut className="w-4 h-4" />
              </button>
            </div>
          ) : (
            /* Sign in button */
            <button
              onClick={handleSignIn}
              className="flex items-center space-x-2 bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 rounded-full px-4 py-2 transition-all touch-manipulation"
            >
              <LogIn className="w-4 h-4" />
              <span className="hidden sm:inline text-sm font-medium">{t('landing.signIn')}</span>
            </button>
          )}
        </div>
      </div>
    </header>
  );
};

export default Header;